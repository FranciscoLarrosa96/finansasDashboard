import{Ca as p,Da as n,Ea as f,Fa as b,Ha as w,Ka as y,La as v,Ma as I,Oa as u,Pa as S,Ta as P,Ua as l,Wa as U,ca as a,e as r,m as g,na as h,p as s,qa as d,z as m}from"./chunk-Q365JZA6.js";var E=class o{app=d(U.firebaseConfig);db=S(this.app);auth=s(w);router=s(h);userSignal=m(null);user=a(()=>this.userSignal());isLoggedIn=a(()=>this.user()!==null);constructor(){y(this.auth).subscribe(t=>{this.userSignal.set(t),t?console.log("Usuario logueado:",t):console.log("No hay usuario logueado")})}loginWithGoogle(){return r(this,null,function*(){let t=new p,e=yield v(this.auth,t),i=e.user,c=u(this.db,"usuarios",i.uid);return(yield P(c)).exists()||(yield l(c,{email:i.email,nombre:i.displayName||"Sin nombre",ingresos:0,gastos:0,creadoEn:new Date})),e})}isGoogleAccount(t){return r(this,null,function*(){return(yield b(this.auth,t)).includes("google.com")})}loginWithEmail(t,e){return f(this.auth,t,e)}registerWithEmail(t,e){return r(this,null,function*(){let i=yield n(this.auth,t,e);return yield this.createUserInFirestore(i.user),i})}logout(){return I(this.auth).then(()=>{this.router.navigate(["/login"])})}register(t,e){return n(this.auth,t,e)}createUserInFirestore(t){return r(this,null,function*(){let e=u(this.db,"usuarios",t.uid);yield l(e,{email:t.email,nombre:t.displayName||"Sin nombre",ingresos:0,gastos:0,creadoEn:new Date})})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=g({token:o,factory:o.\u0275fac,providedIn:"root"})};export{E as a};
